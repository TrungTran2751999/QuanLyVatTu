<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div style="font-size: 14pt;" id="table-data">
        <meta charset="UTF-8">
        <table border="0" cellspacing="0" cellpadding="0" width="615">
            <tbody>
                <tr>
                    <td width="255" valign="top">
                        <p align="center">
                            <strong>CÔNG TY CỔ PHẦN CẤP NƯỚC THỪA THIÊN HUẾ</strong>
                        </p>
                    </td>
                    <td width="359" valign="top">
                        <p align="center">
                            <strong>
                                CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM Độc lập - Tự do -
                                Hạnh phúc
                            </strong>
                        </p>
                        <p align="center">
                            <strong></strong>
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>
        <div id="content">
            <p align="center">
                <strong>PHIẾU ĐỀ NGHỊ CUNG CẤP VẬT TƯ</strong>
            </p>
            <p align="center">
                <strong><em>Kính trình:</em></strong>
            </p>
            <p>
                Người đề nghị:
            </p>
            <p>
                Bộ phận công tác:
            </p>
            <p>
                Mục đích sử dụng:
            </p>
            <p>
                Căn cứ:
            </p>
            <p>
                <em>Đề nghị Công ty cung cấp những vật tư sau:</em></strong>
            </p>
            <table border="1" cellspacing="0" cellpadding="0">
                <tbody>
                    <tr>
                        <td width="86" valign="top">
                            <p align="center">
                                <strong>STT</strong>
                            </p>
                        </td>
                        <td width="112" valign="top">
                            <p align="center">
                                <strong>Tên vật tư, hàng hóa</strong>
                            </p>
                        </td>
                        <td width="61" valign="top">
                            <p align="center">
                                <strong>Đơn vị tính</strong>
                            </p>
                        </td>
                        <td width="86" valign="top">
                            <p align="center">
                                <strong>Quy cách, đặc tính</strong>
                            </p>
                        </td>
                        <td width="86" valign="top">
                            <p align="center">
                                <strong>Số lượng đề nghị</strong>
                            </p>
                        </td>
                        <td width="86" valign="top">
                            <p align="center">
                                <strong>Số lượng được duyệt</strong>
                            </p>
                        </td>
                        <td width="86" valign="top">
                            <p align="center">
                                <strong>Ghi chú</strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td width="86" valign="top">
                            <p>
                                <strong><em>1</em></strong>
                            </p>
                        </td>
                        <td width="112" valign="top">
                            <p>
                                <strong><em></em></strong>
                            </p>
                        </td>
                        <td width="61" valign="top">
                            <p>
                                <strong><em></em></strong>
                            </p>
                        </td>
                        <td width="86" valign="top">
                            <p>
                                <strong><em></em></strong>
                            </p>
                        </td>
                        <td width="86" valign="top">
                            <p>
                                <strong><em></em></strong>
                            </p>
                        </td>
                        <td width="86" valign="top">
                            <p>
                                <strong><em></em></strong>
                            </p>
                        </td>
                        <td width="86" valign="top">
                            <p>
                                <strong><em></em></strong>
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td width="86" valign="top">
                            <p>
                                <strong><em>2</em></strong>
                            </p>
                        </td>
                        <td width="112" valign="top">
                            <p>
                                <strong><em></em></strong>
                            </p>
                        </td>
                        <td width="61" valign="top">
                            <p>
                                <strong><em></em></strong>
                            </p>
                        </td>
                        <td width="86" valign="top">
                            <p>
                                <strong><em></em></strong>
                            </p>
                        </td>
                        <td width="86" valign="top">
                            <p>
                                <strong><em></em></strong>
                            </p>
                        </td>
                        <td width="86" valign="top">
                            <p>
                                <strong><em></em></strong>
                            </p>
                        </td>
                        <td width="86" valign="top">
                            <p>
                                <strong><em></em></strong>
                            </p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <p>
                <strong><em>Dự kiến:</em></strong>
                <em>Cấp từ kho công ty hoặc giao đơn vị mua sắm</em>
            </p>
            <p align="right">
                <em>Huế ngày 19 tháng 10 năm 2023</em>
            </p>
            <table border="0" cellspacing="0" cellpadding="0">
                <tbody>
                    <tr>
                        <td width="201" valign="top">
                            <p align="center">
                                <strong>Lãnh đạo phụ trách</strong>
                            </p>
                            <p align="center">
                                <em>(Ký, ghi rõ họ tên)</em>
                            </p>
                        </td>
                        <td width="201" valign="top">
                            <p align="center">
                                <strong>Bộ phận trưởng</strong>
                            </p>
                            <p align="center">
                                <em>(Ký, ghi rõ họ tên)</em>
                            </p>
                        </td>
                        <td width="201" valign="top">
                            <p align="center">
                                <strong>Người đề nghị</strong>
                            </p>
                            <p align="center">
                                <em>(Ký, ghi rõ họ tên)</em>
                            </p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <p align="center">
                <em></em>
            </p>
        </div>

    </div>
    <button onclick="convert()">CONVERT</button>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.min.js"></script>
    <script src="https://unpkg.com/html-docx-js/dist/html-docx.js"></script>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script>
        function convertHtmlToWord(htmlContent, fileName) {
            // const converted = htmlDocx.asBlob(htmlContent);
            // saveAs(converted, fileName + ".docx");

            Office.initialize = function () {
                Word.run(function (context) {
                    const doc = context.document;
                    const sections = doc.sections;

                    // Set the orientation of the first section to landscape
                    sections.getFirst().pageSetup.orientation = Word.Orientation.landscape;

                    // Set the page width and height to fit a horizontal page
                    sections.getFirst().pageSetup.pageWidth = 842; // Page width in points (11.7 inches)
                    sections.getFirst().pageSetup.pageHeight = 595; // Page height in points (8.3 inches)

                    return context.sync()
                        .then(function () {
                            console.log('Horizontal page created.');

                            // Convert the HTML content to Word document
                            const htmlContent = document.documentElement.outerHTML;
                            const wordDocument = htmlDocx.asBlob(htmlContent);

                            // Download the Word document
                            const downloadLink = document.createElement('a');
                            downloadLink.href = URL.createObjectURL(wordDocument);
                            downloadLink.download = 'horizontal_page.docx';
                            downloadLink.click();
                        })
                        .catch(function (error) {
                            console.log(error);
                        });
                });
            };

        }
        let table = $("#table-data").html();
        console.log(table);
        function convert() {
            convertHtmlToWord(table, "table");
        }
    </script>
</body>

</html>
<html>